{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "a99cd607-8edd-45d1-902b-9fa5b33e6702",
   "metadata": {},
   "source": [
    "Task 2: Tallying up Fare Amount, Tip_Amount, trip distance \n",
    "\n",
    "We have an the entire Q1 2023 taxi data, but we need to compile it into daily sums so we can then analyze this, we will want to keep the file intact too, b/c we will need to use all the data as well as the compilations"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "068e3ae8-2e86-4094-95cf-d0ea51fbf307",
   "metadata": {},
   "outputs": [],
   "source": [
    "path1: r\"C:\\Users\\reece\\Downloads\\Final Project - Career Foundry\\Final working files\\Monthly Borough Taxi Reports\\Prepared Data\\Final Folder\\Q12023NYCYellow.csv\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 110,
   "id": "49e1da42-d28f-403b-84dc-93226a5179a9",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Pick Up Borough</th>\n",
       "      <th>Pick Up Zone</th>\n",
       "      <th>tpep_pickup_datetime</th>\n",
       "      <th>trip_distance</th>\n",
       "      <th>fare_amount</th>\n",
       "      <th>tip_amount</th>\n",
       "      <th>total_amount</th>\n",
       "      <th>fare_amount_flag</th>\n",
       "      <th>Trip_Distance_Flag</th>\n",
       "      <th>Airport(Y/N)</th>\n",
       "      <th>PU_time_of_day</th>\n",
       "      <th>DO_time_of_day</th>\n",
       "      <th>Drop Off Borough</th>\n",
       "      <th>Drop Off Zone</th>\n",
       "      <th>Payment_Type_Description</th>\n",
       "      <th>Date</th>\n",
       "      <th>Time</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>EWR</td>\n",
       "      <td>Newark Airport</td>\n",
       "      <td>2022-10-24 17:37:47</td>\n",
       "      <td>0.00</td>\n",
       "      <td>120.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>120.30</td>\n",
       "      <td>High Fare</td>\n",
       "      <td>Low distance trip</td>\n",
       "      <td>Y</td>\n",
       "      <td>12:01pm - 6pm, Mid-Afternoon</td>\n",
       "      <td>12:01pm - 6pm, Mid-Afternoon</td>\n",
       "      <td>EWR</td>\n",
       "      <td>Newark Airport</td>\n",
       "      <td>Cash</td>\n",
       "      <td>2022-10-24</td>\n",
       "      <td>17:37:47</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>EWR</td>\n",
       "      <td>Newark Airport</td>\n",
       "      <td>2023-01-01 05:36:23</td>\n",
       "      <td>0.00</td>\n",
       "      <td>116.0</td>\n",
       "      <td>1.11</td>\n",
       "      <td>118.11</td>\n",
       "      <td>High Fare</td>\n",
       "      <td>Low distance trip</td>\n",
       "      <td>Y</td>\n",
       "      <td>12:01am - 6am, Early Morning</td>\n",
       "      <td>12:01am - 6am, Early Morning</td>\n",
       "      <td>EWR</td>\n",
       "      <td>Newark Airport</td>\n",
       "      <td>Credit card</td>\n",
       "      <td>2023-01-01</td>\n",
       "      <td>05:36:23</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>EWR</td>\n",
       "      <td>Newark Airport</td>\n",
       "      <td>2023-01-01 08:17:01</td>\n",
       "      <td>0.00</td>\n",
       "      <td>89.0</td>\n",
       "      <td>10.00</td>\n",
       "      <td>100.00</td>\n",
       "      <td>High Fare</td>\n",
       "      <td>Low distance trip</td>\n",
       "      <td>Y</td>\n",
       "      <td>6:01am - 12pm, Morning</td>\n",
       "      <td>6:01am - 12pm, Morning</td>\n",
       "      <td>EWR</td>\n",
       "      <td>Newark Airport</td>\n",
       "      <td>Credit card</td>\n",
       "      <td>2023-01-01</td>\n",
       "      <td>08:17:01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>EWR</td>\n",
       "      <td>Newark Airport</td>\n",
       "      <td>2023-01-01 11:47:43</td>\n",
       "      <td>0.00</td>\n",
       "      <td>95.0</td>\n",
       "      <td>19.20</td>\n",
       "      <td>115.20</td>\n",
       "      <td>High Fare</td>\n",
       "      <td>Low distance trip</td>\n",
       "      <td>Y</td>\n",
       "      <td>6:01am - 12pm, Morning</td>\n",
       "      <td>6:01am - 12pm, Morning</td>\n",
       "      <td>EWR</td>\n",
       "      <td>Newark Airport</td>\n",
       "      <td>Credit card</td>\n",
       "      <td>2023-01-01</td>\n",
       "      <td>11:47:43</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>EWR</td>\n",
       "      <td>Newark Airport</td>\n",
       "      <td>2022-10-25 03:45:46</td>\n",
       "      <td>0.02</td>\n",
       "      <td>115.0</td>\n",
       "      <td>5.00</td>\n",
       "      <td>120.30</td>\n",
       "      <td>High Fare</td>\n",
       "      <td>Low distance trip</td>\n",
       "      <td>Y</td>\n",
       "      <td>12:01am - 6am, Early Morning</td>\n",
       "      <td>12:01am - 6am, Early Morning</td>\n",
       "      <td>EWR</td>\n",
       "      <td>Newark Airport</td>\n",
       "      <td>Credit card</td>\n",
       "      <td>2022-10-25</td>\n",
       "      <td>03:45:46</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  Pick Up Borough    Pick Up Zone tpep_pickup_datetime  trip_distance  \\\n",
       "0             EWR  Newark Airport  2022-10-24 17:37:47           0.00   \n",
       "1             EWR  Newark Airport  2023-01-01 05:36:23           0.00   \n",
       "2             EWR  Newark Airport  2023-01-01 08:17:01           0.00   \n",
       "3             EWR  Newark Airport  2023-01-01 11:47:43           0.00   \n",
       "4             EWR  Newark Airport  2022-10-25 03:45:46           0.02   \n",
       "\n",
       "   fare_amount  tip_amount  total_amount fare_amount_flag Trip_Distance_Flag  \\\n",
       "0        120.0        0.00        120.30        High Fare  Low distance trip   \n",
       "1        116.0        1.11        118.11        High Fare  Low distance trip   \n",
       "2         89.0       10.00        100.00        High Fare  Low distance trip   \n",
       "3         95.0       19.20        115.20        High Fare  Low distance trip   \n",
       "4        115.0        5.00        120.30        High Fare  Low distance trip   \n",
       "\n",
       "  Airport(Y/N)                PU_time_of_day                DO_time_of_day  \\\n",
       "0            Y  12:01pm - 6pm, Mid-Afternoon  12:01pm - 6pm, Mid-Afternoon   \n",
       "1            Y  12:01am - 6am, Early Morning  12:01am - 6am, Early Morning   \n",
       "2            Y        6:01am - 12pm, Morning        6:01am - 12pm, Morning   \n",
       "3            Y        6:01am - 12pm, Morning        6:01am - 12pm, Morning   \n",
       "4            Y  12:01am - 6am, Early Morning  12:01am - 6am, Early Morning   \n",
       "\n",
       "  Drop Off Borough   Drop Off Zone Payment_Type_Description        Date  \\\n",
       "0              EWR  Newark Airport                     Cash  2022-10-24   \n",
       "1              EWR  Newark Airport              Credit card  2023-01-01   \n",
       "2              EWR  Newark Airport              Credit card  2023-01-01   \n",
       "3              EWR  Newark Airport              Credit card  2023-01-01   \n",
       "4              EWR  Newark Airport              Credit card  2022-10-25   \n",
       "\n",
       "       Time  \n",
       "0  17:37:47  \n",
       "1  05:36:23  \n",
       "2  08:17:01  \n",
       "3  11:47:43  \n",
       "4  03:45:46  "
      ]
     },
     "execution_count": 110,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Importing libraries and importing file that you want to work with\n",
    "import pandas as pd\n",
    "import pandas as pd\n",
    "import pyarrow.parquet as pq\n",
    "import os\n",
    "path1 = r\"C:\\Users\\reece\\Downloads\\Final Project - Career Foundry\\Final working files\\Monthly Borough Taxi Reports\\Prepared Data\\Final Folder\\Q12023NYCYellow.csv\"\n",
    "df = pd.read_csv(path1)\n",
    "df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 66,
   "id": "15589dde-076e-4eb0-bd6e-2e99e0735acd",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(12093806, 17)"
      ]
     },
     "execution_count": 66,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Ran the Shape command to give an idea of how large the dataframe is and how many columns\n",
    "df.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b9e6f6f4-71c6-4551-a23e-ab24d1bd5e93",
   "metadata": {},
   "outputs": [],
   "source": [
    "#At this point we need to break out the a daily sum for each unqiue borough and date"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 113,
   "id": "3f8da418-b5fc-44ec-a5c1-5d66bd8dd6a2",
   "metadata": {},
   "outputs": [],
   "source": [
    "df['fare_amount_sums'] = df.groupby(['Pick Up Borough', 'Date'])['fare_amount'].transform('sum')\n",
    "df['trip_distance_sums'] = df.groupby(['Pick Up Borough', 'Date'])['trip_distance'].transform('sum')\n",
    "df['total_amount_sums'] = df.groupby(['Pick Up Borough', 'Date'])['total_amount'].transform('sum')\n",
    "df['tip_amount_sums'] = df.groupby(['Pick Up Borough', 'Date'])['tip_amount'].transform('sum')\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 116,
   "id": "5bf0f29e-39a2-4108-89de-f5736a98566c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Pick Up Borough</th>\n",
       "      <th>Pick Up Zone</th>\n",
       "      <th>tpep_pickup_datetime</th>\n",
       "      <th>trip_distance</th>\n",
       "      <th>fare_amount</th>\n",
       "      <th>tip_amount</th>\n",
       "      <th>total_amount</th>\n",
       "      <th>fare_amount_flag</th>\n",
       "      <th>Trip_Distance_Flag</th>\n",
       "      <th>Airport(Y/N)</th>\n",
       "      <th>...</th>\n",
       "      <th>DO_time_of_day</th>\n",
       "      <th>Drop Off Borough</th>\n",
       "      <th>Drop Off Zone</th>\n",
       "      <th>Payment_Type_Description</th>\n",
       "      <th>Date</th>\n",
       "      <th>Time</th>\n",
       "      <th>fare_amount_sums</th>\n",
       "      <th>trip_distance_sums</th>\n",
       "      <th>total_amount_sums</th>\n",
       "      <th>tip_amount_sums</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>12093706</th>\n",
       "      <td>Manhattan</td>\n",
       "      <td>Yorkville West</td>\n",
       "      <td>2023-04-30 21:51:50</td>\n",
       "      <td>0.49</td>\n",
       "      <td>4.4</td>\n",
       "      <td>1.88</td>\n",
       "      <td>11.28</td>\n",
       "      <td>Low Fare</td>\n",
       "      <td>Low distance trip</td>\n",
       "      <td>N</td>\n",
       "      <td>...</td>\n",
       "      <td>6:01pm - 12am, Evening</td>\n",
       "      <td>Manhattan</td>\n",
       "      <td>Upper East Side North</td>\n",
       "      <td>Credit card</td>\n",
       "      <td>2023-04-30</td>\n",
       "      <td>21:51:50</td>\n",
       "      <td>1255745.38</td>\n",
       "      <td>200429.95</td>\n",
       "      <td>1842751.43</td>\n",
       "      <td>231985.14</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12093707</th>\n",
       "      <td>Manhattan</td>\n",
       "      <td>Yorkville West</td>\n",
       "      <td>2023-04-30 21:03:40</td>\n",
       "      <td>1.83</td>\n",
       "      <td>10.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>15.00</td>\n",
       "      <td>Average Fare</td>\n",
       "      <td>Average trip</td>\n",
       "      <td>N</td>\n",
       "      <td>...</td>\n",
       "      <td>6:01pm - 12am, Evening</td>\n",
       "      <td>Manhattan</td>\n",
       "      <td>Lenox Hill West</td>\n",
       "      <td>Cash</td>\n",
       "      <td>2023-04-30</td>\n",
       "      <td>21:03:40</td>\n",
       "      <td>1255745.38</td>\n",
       "      <td>200429.95</td>\n",
       "      <td>1842751.43</td>\n",
       "      <td>231985.14</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12093708</th>\n",
       "      <td>Manhattan</td>\n",
       "      <td>Yorkville West</td>\n",
       "      <td>2023-04-30 21:24:00</td>\n",
       "      <td>2.04</td>\n",
       "      <td>13.5</td>\n",
       "      <td>3.70</td>\n",
       "      <td>22.20</td>\n",
       "      <td>Average Fare</td>\n",
       "      <td>Average trip</td>\n",
       "      <td>N</td>\n",
       "      <td>...</td>\n",
       "      <td>6:01pm - 12am, Evening</td>\n",
       "      <td>Manhattan</td>\n",
       "      <td>Upper West Side North</td>\n",
       "      <td>Credit card</td>\n",
       "      <td>2023-04-30</td>\n",
       "      <td>21:24:00</td>\n",
       "      <td>1255745.38</td>\n",
       "      <td>200429.95</td>\n",
       "      <td>1842751.43</td>\n",
       "      <td>231985.14</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12093709</th>\n",
       "      <td>Manhattan</td>\n",
       "      <td>Yorkville West</td>\n",
       "      <td>2023-04-30 21:15:10</td>\n",
       "      <td>0.40</td>\n",
       "      <td>5.1</td>\n",
       "      <td>2.02</td>\n",
       "      <td>12.12</td>\n",
       "      <td>Low Fare</td>\n",
       "      <td>Low distance trip</td>\n",
       "      <td>N</td>\n",
       "      <td>...</td>\n",
       "      <td>6:01pm - 12am, Evening</td>\n",
       "      <td>Manhattan</td>\n",
       "      <td>Upper East Side North</td>\n",
       "      <td>Credit card</td>\n",
       "      <td>2023-04-30</td>\n",
       "      <td>21:15:10</td>\n",
       "      <td>1255745.38</td>\n",
       "      <td>200429.95</td>\n",
       "      <td>1842751.43</td>\n",
       "      <td>231985.14</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12093710</th>\n",
       "      <td>Manhattan</td>\n",
       "      <td>Yorkville West</td>\n",
       "      <td>2023-04-30 21:57:38</td>\n",
       "      <td>1.39</td>\n",
       "      <td>7.9</td>\n",
       "      <td>2.58</td>\n",
       "      <td>15.48</td>\n",
       "      <td>Low Fare</td>\n",
       "      <td>Average trip</td>\n",
       "      <td>N</td>\n",
       "      <td>...</td>\n",
       "      <td>6:01pm - 12am, Evening</td>\n",
       "      <td>Manhattan</td>\n",
       "      <td>East Harlem North</td>\n",
       "      <td>Credit card</td>\n",
       "      <td>2023-04-30</td>\n",
       "      <td>21:57:38</td>\n",
       "      <td>1255745.38</td>\n",
       "      <td>200429.95</td>\n",
       "      <td>1842751.43</td>\n",
       "      <td>231985.14</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12093801</th>\n",
       "      <td>Manhattan</td>\n",
       "      <td>Yorkville West</td>\n",
       "      <td>2023-04-30 23:28:23</td>\n",
       "      <td>6.18</td>\n",
       "      <td>28.2</td>\n",
       "      <td>0.00</td>\n",
       "      <td>33.20</td>\n",
       "      <td>Average Fare</td>\n",
       "      <td>High distance trip</td>\n",
       "      <td>N</td>\n",
       "      <td>...</td>\n",
       "      <td>6:01pm - 12am, Evening</td>\n",
       "      <td>Brooklyn</td>\n",
       "      <td>East Williamsburg</td>\n",
       "      <td>Cash</td>\n",
       "      <td>2023-04-30</td>\n",
       "      <td>23:28:23</td>\n",
       "      <td>1255745.38</td>\n",
       "      <td>200429.95</td>\n",
       "      <td>1842751.43</td>\n",
       "      <td>231985.14</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12093802</th>\n",
       "      <td>Manhattan</td>\n",
       "      <td>Yorkville West</td>\n",
       "      <td>2023-04-30 23:17:45</td>\n",
       "      <td>5.94</td>\n",
       "      <td>24.7</td>\n",
       "      <td>0.00</td>\n",
       "      <td>29.70</td>\n",
       "      <td>Average Fare</td>\n",
       "      <td>High distance trip</td>\n",
       "      <td>N</td>\n",
       "      <td>...</td>\n",
       "      <td>6:01pm - 12am, Evening</td>\n",
       "      <td>Manhattan</td>\n",
       "      <td>Two Bridges/Seward Park</td>\n",
       "      <td>Cash</td>\n",
       "      <td>2023-04-30</td>\n",
       "      <td>23:17:45</td>\n",
       "      <td>1255745.38</td>\n",
       "      <td>200429.95</td>\n",
       "      <td>1842751.43</td>\n",
       "      <td>231985.14</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12093803</th>\n",
       "      <td>Manhattan</td>\n",
       "      <td>Yorkville West</td>\n",
       "      <td>2023-04-30 23:50:08</td>\n",
       "      <td>9.70</td>\n",
       "      <td>40.1</td>\n",
       "      <td>9.00</td>\n",
       "      <td>54.10</td>\n",
       "      <td>High Fare</td>\n",
       "      <td>High distance trip</td>\n",
       "      <td>N</td>\n",
       "      <td>...</td>\n",
       "      <td>12:01am - 6am, Early Morning</td>\n",
       "      <td>Brooklyn</td>\n",
       "      <td>Clinton Hill</td>\n",
       "      <td>Credit card</td>\n",
       "      <td>2023-04-30</td>\n",
       "      <td>23:50:08</td>\n",
       "      <td>1255745.38</td>\n",
       "      <td>200429.95</td>\n",
       "      <td>1842751.43</td>\n",
       "      <td>231985.14</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12093804</th>\n",
       "      <td>Manhattan</td>\n",
       "      <td>Yorkville West</td>\n",
       "      <td>2023-04-30 23:25:19</td>\n",
       "      <td>3.82</td>\n",
       "      <td>17.7</td>\n",
       "      <td>3.00</td>\n",
       "      <td>25.70</td>\n",
       "      <td>Average Fare</td>\n",
       "      <td>High distance trip</td>\n",
       "      <td>N</td>\n",
       "      <td>...</td>\n",
       "      <td>6:01pm - 12am, Evening</td>\n",
       "      <td>Queens</td>\n",
       "      <td>Long Island City/Hunters Point</td>\n",
       "      <td>Credit card</td>\n",
       "      <td>2023-04-30</td>\n",
       "      <td>23:25:19</td>\n",
       "      <td>1255745.38</td>\n",
       "      <td>200429.95</td>\n",
       "      <td>1842751.43</td>\n",
       "      <td>231985.14</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12093805</th>\n",
       "      <td>Manhattan</td>\n",
       "      <td>Yorkville West</td>\n",
       "      <td>2023-04-30 23:58:37</td>\n",
       "      <td>4.90</td>\n",
       "      <td>21.9</td>\n",
       "      <td>5.35</td>\n",
       "      <td>32.25</td>\n",
       "      <td>Average Fare</td>\n",
       "      <td>High distance trip</td>\n",
       "      <td>N</td>\n",
       "      <td>...</td>\n",
       "      <td>12:01am - 6am, Early Morning</td>\n",
       "      <td>Manhattan</td>\n",
       "      <td>Greenwich Village North</td>\n",
       "      <td>Credit card</td>\n",
       "      <td>2023-04-30</td>\n",
       "      <td>23:58:37</td>\n",
       "      <td>1255745.38</td>\n",
       "      <td>200429.95</td>\n",
       "      <td>1842751.43</td>\n",
       "      <td>231985.14</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>100 rows × 21 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "         Pick Up Borough    Pick Up Zone tpep_pickup_datetime  trip_distance  \\\n",
       "12093706       Manhattan  Yorkville West  2023-04-30 21:51:50           0.49   \n",
       "12093707       Manhattan  Yorkville West  2023-04-30 21:03:40           1.83   \n",
       "12093708       Manhattan  Yorkville West  2023-04-30 21:24:00           2.04   \n",
       "12093709       Manhattan  Yorkville West  2023-04-30 21:15:10           0.40   \n",
       "12093710       Manhattan  Yorkville West  2023-04-30 21:57:38           1.39   \n",
       "...                  ...             ...                  ...            ...   \n",
       "12093801       Manhattan  Yorkville West  2023-04-30 23:28:23           6.18   \n",
       "12093802       Manhattan  Yorkville West  2023-04-30 23:17:45           5.94   \n",
       "12093803       Manhattan  Yorkville West  2023-04-30 23:50:08           9.70   \n",
       "12093804       Manhattan  Yorkville West  2023-04-30 23:25:19           3.82   \n",
       "12093805       Manhattan  Yorkville West  2023-04-30 23:58:37           4.90   \n",
       "\n",
       "          fare_amount  tip_amount  total_amount fare_amount_flag  \\\n",
       "12093706          4.4        1.88         11.28         Low Fare   \n",
       "12093707         10.0        0.00         15.00     Average Fare   \n",
       "12093708         13.5        3.70         22.20     Average Fare   \n",
       "12093709          5.1        2.02         12.12         Low Fare   \n",
       "12093710          7.9        2.58         15.48         Low Fare   \n",
       "...               ...         ...           ...              ...   \n",
       "12093801         28.2        0.00         33.20     Average Fare   \n",
       "12093802         24.7        0.00         29.70     Average Fare   \n",
       "12093803         40.1        9.00         54.10        High Fare   \n",
       "12093804         17.7        3.00         25.70     Average Fare   \n",
       "12093805         21.9        5.35         32.25     Average Fare   \n",
       "\n",
       "          Trip_Distance_Flag Airport(Y/N)  ...                DO_time_of_day  \\\n",
       "12093706   Low distance trip            N  ...        6:01pm - 12am, Evening   \n",
       "12093707        Average trip            N  ...        6:01pm - 12am, Evening   \n",
       "12093708        Average trip            N  ...        6:01pm - 12am, Evening   \n",
       "12093709   Low distance trip            N  ...        6:01pm - 12am, Evening   \n",
       "12093710        Average trip            N  ...        6:01pm - 12am, Evening   \n",
       "...                      ...          ...  ...                           ...   \n",
       "12093801  High distance trip            N  ...        6:01pm - 12am, Evening   \n",
       "12093802  High distance trip            N  ...        6:01pm - 12am, Evening   \n",
       "12093803  High distance trip            N  ...  12:01am - 6am, Early Morning   \n",
       "12093804  High distance trip            N  ...        6:01pm - 12am, Evening   \n",
       "12093805  High distance trip            N  ...  12:01am - 6am, Early Morning   \n",
       "\n",
       "         Drop Off Borough                   Drop Off Zone  \\\n",
       "12093706        Manhattan           Upper East Side North   \n",
       "12093707        Manhattan                 Lenox Hill West   \n",
       "12093708        Manhattan           Upper West Side North   \n",
       "12093709        Manhattan           Upper East Side North   \n",
       "12093710        Manhattan               East Harlem North   \n",
       "...                   ...                             ...   \n",
       "12093801         Brooklyn               East Williamsburg   \n",
       "12093802        Manhattan         Two Bridges/Seward Park   \n",
       "12093803         Brooklyn                    Clinton Hill   \n",
       "12093804           Queens  Long Island City/Hunters Point   \n",
       "12093805        Manhattan         Greenwich Village North   \n",
       "\n",
       "         Payment_Type_Description        Date      Time fare_amount_sums  \\\n",
       "12093706              Credit card  2023-04-30  21:51:50       1255745.38   \n",
       "12093707                     Cash  2023-04-30  21:03:40       1255745.38   \n",
       "12093708              Credit card  2023-04-30  21:24:00       1255745.38   \n",
       "12093709              Credit card  2023-04-30  21:15:10       1255745.38   \n",
       "12093710              Credit card  2023-04-30  21:57:38       1255745.38   \n",
       "...                           ...         ...       ...              ...   \n",
       "12093801                     Cash  2023-04-30  23:28:23       1255745.38   \n",
       "12093802                     Cash  2023-04-30  23:17:45       1255745.38   \n",
       "12093803              Credit card  2023-04-30  23:50:08       1255745.38   \n",
       "12093804              Credit card  2023-04-30  23:25:19       1255745.38   \n",
       "12093805              Credit card  2023-04-30  23:58:37       1255745.38   \n",
       "\n",
       "          trip_distance_sums  total_amount_sums  tip_amount_sums  \n",
       "12093706           200429.95         1842751.43        231985.14  \n",
       "12093707           200429.95         1842751.43        231985.14  \n",
       "12093708           200429.95         1842751.43        231985.14  \n",
       "12093709           200429.95         1842751.43        231985.14  \n",
       "12093710           200429.95         1842751.43        231985.14  \n",
       "...                      ...                ...              ...  \n",
       "12093801           200429.95         1842751.43        231985.14  \n",
       "12093802           200429.95         1842751.43        231985.14  \n",
       "12093803           200429.95         1842751.43        231985.14  \n",
       "12093804           200429.95         1842751.43        231985.14  \n",
       "12093805           200429.95         1842751.43        231985.14  \n",
       "\n",
       "[100 rows x 21 columns]"
      ]
     },
     "execution_count": 116,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.tail(100)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1c99b346-4e82-4ae9-b538-2c6ac2ecc953",
   "metadata": {},
   "source": [
    "Now I have added all the flags to the dataframe, lets now run a loop to break this report into boroughs"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 117,
   "id": "8fc5975f-342d-436e-a794-39629b8c163a",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "df_bronx\n",
      "df_brooklyn\n",
      "df_ewr\n",
      "df_manhattan\n",
      "df_queens\n",
      "df_staten_island\n"
     ]
    }
   ],
   "source": [
    "# Group the DataFrame by \"Pick Up Borough\"\n",
    "grouped = df.groupby(\"Pick Up Borough\")\n",
    "\n",
    "# Create new DataFrames and copy df into them\n",
    "df_boroughs = {}  # Dictionary to store the new DataFrames\n",
    "\n",
    "for borough, group_df in grouped:\n",
    "    # Copy df into a new DataFrame for each borough\n",
    "    df_boroughs[f\"df_{borough.replace(' ', '_').lower()}\"] = group_df.copy()\n",
    "\n",
    "# Print the names of the new DataFrames\n",
    "for df_name in df_boroughs:\n",
    "    print(df_name)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 118,
   "id": "b64e94f0-ea4d-4bdc-b81d-42e21cef3fd4",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_bronx = df[df[\"Pick Up Borough\"] == \"Bronx\"].copy()\n",
    "df_brooklyn = df[df[\"Pick Up Borough\"] == \"Brooklyn\"].copy()\n",
    "df_ewr = df[df[\"Pick Up Borough\"] == \"EWR\"].copy()\n",
    "df_manhattan = df[df[\"Pick Up Borough\"] == \"Manhattan\"].copy()\n",
    "df_queens = df[df[\"Pick Up Borough\"] == \"Queens\"].copy()\n",
    "df_staten_island = df[df[\"Pick Up Borough\"] == \"Staten Island\"].copy()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 119,
   "id": "7d88dec8-7efb-4c1a-adf4-a67181d9e449",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Pick Up Borough</th>\n",
       "      <th>Pick Up Zone</th>\n",
       "      <th>tpep_pickup_datetime</th>\n",
       "      <th>trip_distance</th>\n",
       "      <th>fare_amount</th>\n",
       "      <th>tip_amount</th>\n",
       "      <th>total_amount</th>\n",
       "      <th>fare_amount_flag</th>\n",
       "      <th>Trip_Distance_Flag</th>\n",
       "      <th>Airport(Y/N)</th>\n",
       "      <th>...</th>\n",
       "      <th>DO_time_of_day</th>\n",
       "      <th>Drop Off Borough</th>\n",
       "      <th>Drop Off Zone</th>\n",
       "      <th>Payment_Type_Description</th>\n",
       "      <th>Date</th>\n",
       "      <th>Time</th>\n",
       "      <th>fare_amount_sums</th>\n",
       "      <th>trip_distance_sums</th>\n",
       "      <th>total_amount_sums</th>\n",
       "      <th>tip_amount_sums</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>14495</th>\n",
       "      <td>Staten Island</td>\n",
       "      <td>Arden Heights</td>\n",
       "      <td>2023-01-01 11:19:23</td>\n",
       "      <td>17.3</td>\n",
       "      <td>67.2</td>\n",
       "      <td>0.0</td>\n",
       "      <td>96.20</td>\n",
       "      <td>High Fare</td>\n",
       "      <td>High distance trip</td>\n",
       "      <td>Y</td>\n",
       "      <td>...</td>\n",
       "      <td>12:01pm - 6pm, Mid-Afternoon</td>\n",
       "      <td>Manhattan</td>\n",
       "      <td>Midtown Center</td>\n",
       "      <td>Credit card</td>\n",
       "      <td>2023-01-01</td>\n",
       "      <td>11:19:23</td>\n",
       "      <td>615.8</td>\n",
       "      <td>112.18</td>\n",
       "      <td>714.35</td>\n",
       "      <td>0.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14496</th>\n",
       "      <td>Staten Island</td>\n",
       "      <td>Arden Heights</td>\n",
       "      <td>2023-01-01 16:48:59</td>\n",
       "      <td>23.1</td>\n",
       "      <td>67.2</td>\n",
       "      <td>0.0</td>\n",
       "      <td>96.20</td>\n",
       "      <td>High Fare</td>\n",
       "      <td>High distance trip</td>\n",
       "      <td>Y</td>\n",
       "      <td>...</td>\n",
       "      <td>12:01pm - 6pm, Mid-Afternoon</td>\n",
       "      <td>Unknown</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Credit card</td>\n",
       "      <td>2023-01-01</td>\n",
       "      <td>16:48:59</td>\n",
       "      <td>615.8</td>\n",
       "      <td>112.18</td>\n",
       "      <td>714.35</td>\n",
       "      <td>0.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14497</th>\n",
       "      <td>Staten Island</td>\n",
       "      <td>Arden Heights</td>\n",
       "      <td>2023-01-01 20:53:18</td>\n",
       "      <td>16.2</td>\n",
       "      <td>65.2</td>\n",
       "      <td>0.0</td>\n",
       "      <td>90.20</td>\n",
       "      <td>High Fare</td>\n",
       "      <td>High distance trip</td>\n",
       "      <td>Y</td>\n",
       "      <td>...</td>\n",
       "      <td>6:01pm - 12am, Evening</td>\n",
       "      <td>Manhattan</td>\n",
       "      <td>Gramercy</td>\n",
       "      <td>Credit card</td>\n",
       "      <td>2023-01-01</td>\n",
       "      <td>20:53:18</td>\n",
       "      <td>615.8</td>\n",
       "      <td>112.18</td>\n",
       "      <td>714.35</td>\n",
       "      <td>0.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14498</th>\n",
       "      <td>Staten Island</td>\n",
       "      <td>Arden Heights</td>\n",
       "      <td>2023-01-02 10:57:55</td>\n",
       "      <td>25.2</td>\n",
       "      <td>67.2</td>\n",
       "      <td>0.0</td>\n",
       "      <td>75.25</td>\n",
       "      <td>High Fare</td>\n",
       "      <td>High distance trip</td>\n",
       "      <td>Y</td>\n",
       "      <td>...</td>\n",
       "      <td>6:01am - 12pm, Morning</td>\n",
       "      <td>Queens</td>\n",
       "      <td>Cambria Heights</td>\n",
       "      <td>Credit card</td>\n",
       "      <td>2023-01-02</td>\n",
       "      <td>10:57:55</td>\n",
       "      <td>591.3</td>\n",
       "      <td>127.38</td>\n",
       "      <td>742.81</td>\n",
       "      <td>21.21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14499</th>\n",
       "      <td>Staten Island</td>\n",
       "      <td>Arden Heights</td>\n",
       "      <td>2023-01-02 20:42:31</td>\n",
       "      <td>18.0</td>\n",
       "      <td>67.2</td>\n",
       "      <td>0.0</td>\n",
       "      <td>92.20</td>\n",
       "      <td>High Fare</td>\n",
       "      <td>High distance trip</td>\n",
       "      <td>Y</td>\n",
       "      <td>...</td>\n",
       "      <td>6:01pm - 12am, Evening</td>\n",
       "      <td>Manhattan</td>\n",
       "      <td>Upper East Side South</td>\n",
       "      <td>Credit card</td>\n",
       "      <td>2023-01-02</td>\n",
       "      <td>20:42:31</td>\n",
       "      <td>591.3</td>\n",
       "      <td>127.38</td>\n",
       "      <td>742.81</td>\n",
       "      <td>21.21</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 21 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      Pick Up Borough   Pick Up Zone tpep_pickup_datetime  trip_distance  \\\n",
       "14495   Staten Island  Arden Heights  2023-01-01 11:19:23           17.3   \n",
       "14496   Staten Island  Arden Heights  2023-01-01 16:48:59           23.1   \n",
       "14497   Staten Island  Arden Heights  2023-01-01 20:53:18           16.2   \n",
       "14498   Staten Island  Arden Heights  2023-01-02 10:57:55           25.2   \n",
       "14499   Staten Island  Arden Heights  2023-01-02 20:42:31           18.0   \n",
       "\n",
       "       fare_amount  tip_amount  total_amount fare_amount_flag  \\\n",
       "14495         67.2         0.0         96.20        High Fare   \n",
       "14496         67.2         0.0         96.20        High Fare   \n",
       "14497         65.2         0.0         90.20        High Fare   \n",
       "14498         67.2         0.0         75.25        High Fare   \n",
       "14499         67.2         0.0         92.20        High Fare   \n",
       "\n",
       "       Trip_Distance_Flag Airport(Y/N)  ...                DO_time_of_day  \\\n",
       "14495  High distance trip            Y  ...  12:01pm - 6pm, Mid-Afternoon   \n",
       "14496  High distance trip            Y  ...  12:01pm - 6pm, Mid-Afternoon   \n",
       "14497  High distance trip            Y  ...        6:01pm - 12am, Evening   \n",
       "14498  High distance trip            Y  ...        6:01am - 12pm, Morning   \n",
       "14499  High distance trip            Y  ...        6:01pm - 12am, Evening   \n",
       "\n",
       "      Drop Off Borough          Drop Off Zone Payment_Type_Description  \\\n",
       "14495        Manhattan         Midtown Center              Credit card   \n",
       "14496          Unknown                    NaN              Credit card   \n",
       "14497        Manhattan               Gramercy              Credit card   \n",
       "14498           Queens        Cambria Heights              Credit card   \n",
       "14499        Manhattan  Upper East Side South              Credit card   \n",
       "\n",
       "             Date      Time fare_amount_sums  trip_distance_sums  \\\n",
       "14495  2023-01-01  11:19:23            615.8              112.18   \n",
       "14496  2023-01-01  16:48:59            615.8              112.18   \n",
       "14497  2023-01-01  20:53:18            615.8              112.18   \n",
       "14498  2023-01-02  10:57:55            591.3              127.38   \n",
       "14499  2023-01-02  20:42:31            591.3              127.38   \n",
       "\n",
       "       total_amount_sums  tip_amount_sums  \n",
       "14495             714.35             0.00  \n",
       "14496             714.35             0.00  \n",
       "14497             714.35             0.00  \n",
       "14498             742.81            21.21  \n",
       "14499             742.81            21.21  \n",
       "\n",
       "[5 rows x 21 columns]"
      ]
     },
     "execution_count": 119,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_staten_island.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0845d7ff-2542-48df-9d8b-cfc81d0c3751",
   "metadata": {},
   "source": [
    "Ok, everytyhing has been tallied and now I need to remove the duplicates so that I have one date for each unique value in the Pick Up Borough column\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 122,
   "id": "aa58f177-2394-400c-a71e-4787dfadb08a",
   "metadata": {},
   "outputs": [],
   "source": [
    "# List of DataFrame names\n",
    "df_names = [\"df_bronx\", \"df_brooklyn\", \"df_ewr\", \"df_manhattan\", \"df_queens\", \"df_staten_island\"]\n",
    "\n",
    "# Loop through the DataFrame names and drop duplicates for each DataFrame\n",
    "for name in df_names:\n",
    "    df = globals()[name]  # Get the DataFrame by name\n",
    "    df = df.drop_duplicates(subset=['Date'])  # Drop duplicates based on 'Date' column\n",
    "    globals()[name] = df  # Assign the modified DataFrame back to the variable\n",
    "\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 124,
   "id": "33560f54-5622-435c-8e11-576628441ed8",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Pick Up Borough</th>\n",
       "      <th>Pick Up Zone</th>\n",
       "      <th>tpep_pickup_datetime</th>\n",
       "      <th>trip_distance</th>\n",
       "      <th>fare_amount</th>\n",
       "      <th>tip_amount</th>\n",
       "      <th>total_amount</th>\n",
       "      <th>fare_amount_flag</th>\n",
       "      <th>Trip_Distance_Flag</th>\n",
       "      <th>Airport(Y/N)</th>\n",
       "      <th>...</th>\n",
       "      <th>DO_time_of_day</th>\n",
       "      <th>Drop Off Borough</th>\n",
       "      <th>Drop Off Zone</th>\n",
       "      <th>Payment_Type_Description</th>\n",
       "      <th>Date</th>\n",
       "      <th>Time</th>\n",
       "      <th>fare_amount_sums</th>\n",
       "      <th>trip_distance_sums</th>\n",
       "      <th>total_amount_sums</th>\n",
       "      <th>tip_amount_sums</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1628</th>\n",
       "      <td>Queens</td>\n",
       "      <td>Jamaica Bay</td>\n",
       "      <td>2023-01-28 17:03:38</td>\n",
       "      <td>6.56</td>\n",
       "      <td>27.5</td>\n",
       "      <td>0.00</td>\n",
       "      <td>29.00</td>\n",
       "      <td>Average Fare</td>\n",
       "      <td>High distance trip</td>\n",
       "      <td>Y</td>\n",
       "      <td>...</td>\n",
       "      <td>12:01pm - 6pm, Mid-Afternoon</td>\n",
       "      <td>Queens</td>\n",
       "      <td>Rockaway Park</td>\n",
       "      <td>Dispute</td>\n",
       "      <td>2023-01-28</td>\n",
       "      <td>17:03:38</td>\n",
       "      <td>318271.40</td>\n",
       "      <td>78066.43</td>\n",
       "      <td>418719.19</td>\n",
       "      <td>47643.83</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1629</th>\n",
       "      <td>Queens</td>\n",
       "      <td>Jamaica Bay</td>\n",
       "      <td>2023-02-06 11:45:03</td>\n",
       "      <td>18.91</td>\n",
       "      <td>70.0</td>\n",
       "      <td>16.11</td>\n",
       "      <td>96.66</td>\n",
       "      <td>High Fare</td>\n",
       "      <td>High distance trip</td>\n",
       "      <td>N</td>\n",
       "      <td>...</td>\n",
       "      <td>12:01pm - 6pm, Mid-Afternoon</td>\n",
       "      <td>Manhattan</td>\n",
       "      <td>Midtown South</td>\n",
       "      <td>Credit card</td>\n",
       "      <td>2023-02-06</td>\n",
       "      <td>11:45:03</td>\n",
       "      <td>495093.74</td>\n",
       "      <td>119477.36</td>\n",
       "      <td>677694.21</td>\n",
       "      <td>82130.87</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1630</th>\n",
       "      <td>Queens</td>\n",
       "      <td>Jamaica Bay</td>\n",
       "      <td>2023-02-13 07:04:57</td>\n",
       "      <td>18.20</td>\n",
       "      <td>70.0</td>\n",
       "      <td>10.00</td>\n",
       "      <td>91.80</td>\n",
       "      <td>High Fare</td>\n",
       "      <td>High distance trip</td>\n",
       "      <td>N</td>\n",
       "      <td>...</td>\n",
       "      <td>6:01am - 12pm, Morning</td>\n",
       "      <td>Manhattan</td>\n",
       "      <td>West Village</td>\n",
       "      <td>Credit card</td>\n",
       "      <td>2023-02-13</td>\n",
       "      <td>07:04:57</td>\n",
       "      <td>470720.77</td>\n",
       "      <td>113769.17</td>\n",
       "      <td>638928.40</td>\n",
       "      <td>74865.59</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1631</th>\n",
       "      <td>Queens</td>\n",
       "      <td>Jamaica Bay</td>\n",
       "      <td>2023-03-07 17:32:18</td>\n",
       "      <td>3.72</td>\n",
       "      <td>19.8</td>\n",
       "      <td>0.00</td>\n",
       "      <td>26.25</td>\n",
       "      <td>Average Fare</td>\n",
       "      <td>High distance trip</td>\n",
       "      <td>N</td>\n",
       "      <td>...</td>\n",
       "      <td>12:01pm - 6pm, Mid-Afternoon</td>\n",
       "      <td>Queens</td>\n",
       "      <td>Rockaway Park</td>\n",
       "      <td>Cash</td>\n",
       "      <td>2023-03-07</td>\n",
       "      <td>17:32:18</td>\n",
       "      <td>472179.68</td>\n",
       "      <td>111404.88</td>\n",
       "      <td>647210.10</td>\n",
       "      <td>76544.65</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1632</th>\n",
       "      <td>Queens</td>\n",
       "      <td>Jamaica Bay</td>\n",
       "      <td>2023-03-29 10:17:09</td>\n",
       "      <td>8.20</td>\n",
       "      <td>40.8</td>\n",
       "      <td>10.25</td>\n",
       "      <td>61.60</td>\n",
       "      <td>High Fare</td>\n",
       "      <td>High distance trip</td>\n",
       "      <td>N</td>\n",
       "      <td>...</td>\n",
       "      <td>6:01am - 12pm, Morning</td>\n",
       "      <td>Manhattan</td>\n",
       "      <td>Midtown South</td>\n",
       "      <td>Credit card</td>\n",
       "      <td>2023-03-29</td>\n",
       "      <td>10:17:09</td>\n",
       "      <td>542592.05</td>\n",
       "      <td>128677.14</td>\n",
       "      <td>736050.09</td>\n",
       "      <td>84588.15</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1633</th>\n",
       "      <td>Queens</td>\n",
       "      <td>Jamaica Bay</td>\n",
       "      <td>2023-03-31 19:59:30</td>\n",
       "      <td>5.48</td>\n",
       "      <td>24.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>30.45</td>\n",
       "      <td>Average Fare</td>\n",
       "      <td>High distance trip</td>\n",
       "      <td>N</td>\n",
       "      <td>...</td>\n",
       "      <td>6:01pm - 12am, Evening</td>\n",
       "      <td>Queens</td>\n",
       "      <td>Rockaway Park</td>\n",
       "      <td>Cash</td>\n",
       "      <td>2023-03-31</td>\n",
       "      <td>19:59:30</td>\n",
       "      <td>587925.59</td>\n",
       "      <td>140414.52</td>\n",
       "      <td>797097.14</td>\n",
       "      <td>93543.88</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1634</th>\n",
       "      <td>Queens</td>\n",
       "      <td>Jamaica Bay</td>\n",
       "      <td>2023-04-01 12:11:27</td>\n",
       "      <td>5.27</td>\n",
       "      <td>24.0</td>\n",
       "      <td>1.40</td>\n",
       "      <td>29.35</td>\n",
       "      <td>Average Fare</td>\n",
       "      <td>High distance trip</td>\n",
       "      <td>N</td>\n",
       "      <td>...</td>\n",
       "      <td>12:01pm - 6pm, Mid-Afternoon</td>\n",
       "      <td>Queens</td>\n",
       "      <td>Rockaway Park</td>\n",
       "      <td>Credit card</td>\n",
       "      <td>2023-04-01</td>\n",
       "      <td>12:11:27</td>\n",
       "      <td>475279.63</td>\n",
       "      <td>117067.61</td>\n",
       "      <td>626875.79</td>\n",
       "      <td>71834.24</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14884</th>\n",
       "      <td>Queens</td>\n",
       "      <td>Astoria</td>\n",
       "      <td>2023-01-01 00:18:49</td>\n",
       "      <td>1.70</td>\n",
       "      <td>9.3</td>\n",
       "      <td>0.00</td>\n",
       "      <td>11.80</td>\n",
       "      <td>Low Fare</td>\n",
       "      <td>Average trip</td>\n",
       "      <td>Y</td>\n",
       "      <td>...</td>\n",
       "      <td>12:01am - 6am, Early Morning</td>\n",
       "      <td>Queens</td>\n",
       "      <td>Jackson Heights</td>\n",
       "      <td>Credit card</td>\n",
       "      <td>2023-01-01</td>\n",
       "      <td>00:18:49</td>\n",
       "      <td>478869.69</td>\n",
       "      <td>117567.92</td>\n",
       "      <td>631084.75</td>\n",
       "      <td>73956.80</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14971</th>\n",
       "      <td>Queens</td>\n",
       "      <td>Astoria</td>\n",
       "      <td>2023-01-02 00:01:31</td>\n",
       "      <td>2.18</td>\n",
       "      <td>11.4</td>\n",
       "      <td>0.00</td>\n",
       "      <td>13.90</td>\n",
       "      <td>Average Fare</td>\n",
       "      <td>Average trip</td>\n",
       "      <td>Y</td>\n",
       "      <td>...</td>\n",
       "      <td>12:01am - 6am, Early Morning</td>\n",
       "      <td>Queens</td>\n",
       "      <td>Steinway</td>\n",
       "      <td>Cash</td>\n",
       "      <td>2023-01-02</td>\n",
       "      <td>00:01:31</td>\n",
       "      <td>561022.75</td>\n",
       "      <td>138309.03</td>\n",
       "      <td>748325.34</td>\n",
       "      <td>89535.03</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15007</th>\n",
       "      <td>Queens</td>\n",
       "      <td>Astoria</td>\n",
       "      <td>2023-01-03 01:22:43</td>\n",
       "      <td>2.65</td>\n",
       "      <td>13.5</td>\n",
       "      <td>3.70</td>\n",
       "      <td>22.20</td>\n",
       "      <td>Average Fare</td>\n",
       "      <td>Average trip</td>\n",
       "      <td>Y</td>\n",
       "      <td>...</td>\n",
       "      <td>12:01am - 6am, Early Morning</td>\n",
       "      <td>Manhattan</td>\n",
       "      <td>Sutton Place/Turtle Bay North</td>\n",
       "      <td>Credit card</td>\n",
       "      <td>2023-01-03</td>\n",
       "      <td>01:22:43</td>\n",
       "      <td>600143.78</td>\n",
       "      <td>146121.56</td>\n",
       "      <td>805842.83</td>\n",
       "      <td>91408.31</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>10 rows × 21 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      Pick Up Borough Pick Up Zone tpep_pickup_datetime  trip_distance  \\\n",
       "1628           Queens  Jamaica Bay  2023-01-28 17:03:38           6.56   \n",
       "1629           Queens  Jamaica Bay  2023-02-06 11:45:03          18.91   \n",
       "1630           Queens  Jamaica Bay  2023-02-13 07:04:57          18.20   \n",
       "1631           Queens  Jamaica Bay  2023-03-07 17:32:18           3.72   \n",
       "1632           Queens  Jamaica Bay  2023-03-29 10:17:09           8.20   \n",
       "1633           Queens  Jamaica Bay  2023-03-31 19:59:30           5.48   \n",
       "1634           Queens  Jamaica Bay  2023-04-01 12:11:27           5.27   \n",
       "14884          Queens      Astoria  2023-01-01 00:18:49           1.70   \n",
       "14971          Queens      Astoria  2023-01-02 00:01:31           2.18   \n",
       "15007          Queens      Astoria  2023-01-03 01:22:43           2.65   \n",
       "\n",
       "       fare_amount  tip_amount  total_amount fare_amount_flag  \\\n",
       "1628          27.5        0.00         29.00     Average Fare   \n",
       "1629          70.0       16.11         96.66        High Fare   \n",
       "1630          70.0       10.00         91.80        High Fare   \n",
       "1631          19.8        0.00         26.25     Average Fare   \n",
       "1632          40.8       10.25         61.60        High Fare   \n",
       "1633          24.0        0.00         30.45     Average Fare   \n",
       "1634          24.0        1.40         29.35     Average Fare   \n",
       "14884          9.3        0.00         11.80         Low Fare   \n",
       "14971         11.4        0.00         13.90     Average Fare   \n",
       "15007         13.5        3.70         22.20     Average Fare   \n",
       "\n",
       "       Trip_Distance_Flag Airport(Y/N)  ...                DO_time_of_day  \\\n",
       "1628   High distance trip            Y  ...  12:01pm - 6pm, Mid-Afternoon   \n",
       "1629   High distance trip            N  ...  12:01pm - 6pm, Mid-Afternoon   \n",
       "1630   High distance trip            N  ...        6:01am - 12pm, Morning   \n",
       "1631   High distance trip            N  ...  12:01pm - 6pm, Mid-Afternoon   \n",
       "1632   High distance trip            N  ...        6:01am - 12pm, Morning   \n",
       "1633   High distance trip            N  ...        6:01pm - 12am, Evening   \n",
       "1634   High distance trip            N  ...  12:01pm - 6pm, Mid-Afternoon   \n",
       "14884        Average trip            Y  ...  12:01am - 6am, Early Morning   \n",
       "14971        Average trip            Y  ...  12:01am - 6am, Early Morning   \n",
       "15007        Average trip            Y  ...  12:01am - 6am, Early Morning   \n",
       "\n",
       "      Drop Off Borough                  Drop Off Zone  \\\n",
       "1628            Queens                  Rockaway Park   \n",
       "1629         Manhattan                  Midtown South   \n",
       "1630         Manhattan                   West Village   \n",
       "1631            Queens                  Rockaway Park   \n",
       "1632         Manhattan                  Midtown South   \n",
       "1633            Queens                  Rockaway Park   \n",
       "1634            Queens                  Rockaway Park   \n",
       "14884           Queens                Jackson Heights   \n",
       "14971           Queens                       Steinway   \n",
       "15007        Manhattan  Sutton Place/Turtle Bay North   \n",
       "\n",
       "      Payment_Type_Description        Date      Time fare_amount_sums  \\\n",
       "1628                   Dispute  2023-01-28  17:03:38        318271.40   \n",
       "1629               Credit card  2023-02-06  11:45:03        495093.74   \n",
       "1630               Credit card  2023-02-13  07:04:57        470720.77   \n",
       "1631                      Cash  2023-03-07  17:32:18        472179.68   \n",
       "1632               Credit card  2023-03-29  10:17:09        542592.05   \n",
       "1633                      Cash  2023-03-31  19:59:30        587925.59   \n",
       "1634               Credit card  2023-04-01  12:11:27        475279.63   \n",
       "14884              Credit card  2023-01-01  00:18:49        478869.69   \n",
       "14971                     Cash  2023-01-02  00:01:31        561022.75   \n",
       "15007              Credit card  2023-01-03  01:22:43        600143.78   \n",
       "\n",
       "       trip_distance_sums  total_amount_sums  tip_amount_sums  \n",
       "1628             78066.43          418719.19         47643.83  \n",
       "1629            119477.36          677694.21         82130.87  \n",
       "1630            113769.17          638928.40         74865.59  \n",
       "1631            111404.88          647210.10         76544.65  \n",
       "1632            128677.14          736050.09         84588.15  \n",
       "1633            140414.52          797097.14         93543.88  \n",
       "1634            117067.61          626875.79         71834.24  \n",
       "14884           117567.92          631084.75         73956.80  \n",
       "14971           138309.03          748325.34         89535.03  \n",
       "15007           146121.56          805842.83         91408.31  \n",
       "\n",
       "[10 rows x 21 columns]"
      ]
     },
     "execution_count": 124,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_queens.head(10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 125,
   "id": "3f3c7b37-6e49-45b7-9bac-89314f3d0d0a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Pick Up Borough</th>\n",
       "      <th>Pick Up Zone</th>\n",
       "      <th>tpep_pickup_datetime</th>\n",
       "      <th>trip_distance</th>\n",
       "      <th>fare_amount</th>\n",
       "      <th>tip_amount</th>\n",
       "      <th>total_amount</th>\n",
       "      <th>fare_amount_flag</th>\n",
       "      <th>Trip_Distance_Flag</th>\n",
       "      <th>Airport(Y/N)</th>\n",
       "      <th>...</th>\n",
       "      <th>DO_time_of_day</th>\n",
       "      <th>Drop Off Borough</th>\n",
       "      <th>Drop Off Zone</th>\n",
       "      <th>Payment_Type_Description</th>\n",
       "      <th>Date</th>\n",
       "      <th>Time</th>\n",
       "      <th>fare_amount_sums</th>\n",
       "      <th>trip_distance_sums</th>\n",
       "      <th>total_amount_sums</th>\n",
       "      <th>tip_amount_sums</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>24603</th>\n",
       "      <td>Brooklyn</td>\n",
       "      <td>Bath Beach</td>\n",
       "      <td>2023-01-01 04:15:08</td>\n",
       "      <td>10.09</td>\n",
       "      <td>40.1</td>\n",
       "      <td>0.00</td>\n",
       "      <td>42.60</td>\n",
       "      <td>High Fare</td>\n",
       "      <td>High distance trip</td>\n",
       "      <td>Y</td>\n",
       "      <td>...</td>\n",
       "      <td>12:01am - 6am, Early Morning</td>\n",
       "      <td>Brooklyn</td>\n",
       "      <td>Kensington</td>\n",
       "      <td>Cash</td>\n",
       "      <td>2023-01-01</td>\n",
       "      <td>04:15:08</td>\n",
       "      <td>19877.91</td>\n",
       "      <td>3338.11</td>\n",
       "      <td>24960.94</td>\n",
       "      <td>2574.34</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24604</th>\n",
       "      <td>Brooklyn</td>\n",
       "      <td>Bath Beach</td>\n",
       "      <td>2023-01-03 02:42:34</td>\n",
       "      <td>10.12</td>\n",
       "      <td>39.4</td>\n",
       "      <td>0.00</td>\n",
       "      <td>41.90</td>\n",
       "      <td>High Fare</td>\n",
       "      <td>High distance trip</td>\n",
       "      <td>Y</td>\n",
       "      <td>...</td>\n",
       "      <td>12:01am - 6am, Early Morning</td>\n",
       "      <td>Brooklyn</td>\n",
       "      <td>Kensington</td>\n",
       "      <td>Cash</td>\n",
       "      <td>2023-01-03</td>\n",
       "      <td>02:42:34</td>\n",
       "      <td>12755.90</td>\n",
       "      <td>2155.04</td>\n",
       "      <td>15524.35</td>\n",
       "      <td>1242.20</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24606</th>\n",
       "      <td>Brooklyn</td>\n",
       "      <td>Bath Beach</td>\n",
       "      <td>2023-01-04 16:28:32</td>\n",
       "      <td>0.00</td>\n",
       "      <td>3.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>7.00</td>\n",
       "      <td>Low Fare</td>\n",
       "      <td>Low distance trip</td>\n",
       "      <td>Y</td>\n",
       "      <td>...</td>\n",
       "      <td>12:01pm - 6pm, Mid-Afternoon</td>\n",
       "      <td>Brooklyn</td>\n",
       "      <td>Bath Beach</td>\n",
       "      <td>Dispute</td>\n",
       "      <td>2023-01-04</td>\n",
       "      <td>16:28:32</td>\n",
       "      <td>11176.80</td>\n",
       "      <td>1945.01</td>\n",
       "      <td>13581.55</td>\n",
       "      <td>984.45</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24608</th>\n",
       "      <td>Brooklyn</td>\n",
       "      <td>Bath Beach</td>\n",
       "      <td>2023-01-05 02:07:08</td>\n",
       "      <td>9.91</td>\n",
       "      <td>38.7</td>\n",
       "      <td>8.24</td>\n",
       "      <td>49.44</td>\n",
       "      <td>High Fare</td>\n",
       "      <td>High distance trip</td>\n",
       "      <td>Y</td>\n",
       "      <td>...</td>\n",
       "      <td>12:01am - 6am, Early Morning</td>\n",
       "      <td>Brooklyn</td>\n",
       "      <td>Kensington</td>\n",
       "      <td>Credit card</td>\n",
       "      <td>2023-01-05</td>\n",
       "      <td>02:07:08</td>\n",
       "      <td>12442.38</td>\n",
       "      <td>2103.68</td>\n",
       "      <td>15180.13</td>\n",
       "      <td>1218.10</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24611</th>\n",
       "      <td>Brooklyn</td>\n",
       "      <td>Bath Beach</td>\n",
       "      <td>2023-01-06 06:21:22</td>\n",
       "      <td>21.30</td>\n",
       "      <td>50.5</td>\n",
       "      <td>0.00</td>\n",
       "      <td>52.00</td>\n",
       "      <td>High Fare</td>\n",
       "      <td>High distance trip</td>\n",
       "      <td>Y</td>\n",
       "      <td>...</td>\n",
       "      <td>6:01am - 12pm, Morning</td>\n",
       "      <td>Queens</td>\n",
       "      <td>Far Rockaway</td>\n",
       "      <td>Credit card</td>\n",
       "      <td>2023-01-06</td>\n",
       "      <td>06:21:22</td>\n",
       "      <td>12451.60</td>\n",
       "      <td>2261.11</td>\n",
       "      <td>15349.37</td>\n",
       "      <td>1258.22</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24612</th>\n",
       "      <td>Brooklyn</td>\n",
       "      <td>Bath Beach</td>\n",
       "      <td>2023-01-08 03:13:38</td>\n",
       "      <td>9.91</td>\n",
       "      <td>38.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>40.50</td>\n",
       "      <td>High Fare</td>\n",
       "      <td>High distance trip</td>\n",
       "      <td>Y</td>\n",
       "      <td>...</td>\n",
       "      <td>12:01am - 6am, Early Morning</td>\n",
       "      <td>Brooklyn</td>\n",
       "      <td>Kensington</td>\n",
       "      <td>Cash</td>\n",
       "      <td>2023-01-08</td>\n",
       "      <td>03:13:38</td>\n",
       "      <td>10654.02</td>\n",
       "      <td>1693.36</td>\n",
       "      <td>13000.23</td>\n",
       "      <td>1197.76</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24613</th>\n",
       "      <td>Brooklyn</td>\n",
       "      <td>Bath Beach</td>\n",
       "      <td>2023-01-09 10:50:17</td>\n",
       "      <td>0.60</td>\n",
       "      <td>44.5</td>\n",
       "      <td>0.00</td>\n",
       "      <td>52.55</td>\n",
       "      <td>High Fare</td>\n",
       "      <td>Low distance trip</td>\n",
       "      <td>Y</td>\n",
       "      <td>...</td>\n",
       "      <td>6:01am - 12pm, Morning</td>\n",
       "      <td>Brooklyn</td>\n",
       "      <td>Bath Beach</td>\n",
       "      <td>Credit card</td>\n",
       "      <td>2023-01-09</td>\n",
       "      <td>10:50:17</td>\n",
       "      <td>11345.30</td>\n",
       "      <td>1908.02</td>\n",
       "      <td>13276.23</td>\n",
       "      <td>673.48</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24614</th>\n",
       "      <td>Brooklyn</td>\n",
       "      <td>Bath Beach</td>\n",
       "      <td>2023-01-10 15:21:48</td>\n",
       "      <td>0.60</td>\n",
       "      <td>4.4</td>\n",
       "      <td>0.00</td>\n",
       "      <td>5.90</td>\n",
       "      <td>Low Fare</td>\n",
       "      <td>Low distance trip</td>\n",
       "      <td>Y</td>\n",
       "      <td>...</td>\n",
       "      <td>12:01pm - 6pm, Mid-Afternoon</td>\n",
       "      <td>Brooklyn</td>\n",
       "      <td>Bath Beach</td>\n",
       "      <td>Cash</td>\n",
       "      <td>2023-01-10</td>\n",
       "      <td>15:21:48</td>\n",
       "      <td>12667.05</td>\n",
       "      <td>2107.05</td>\n",
       "      <td>14975.29</td>\n",
       "      <td>886.68</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24615</th>\n",
       "      <td>Brooklyn</td>\n",
       "      <td>Bath Beach</td>\n",
       "      <td>2023-01-11 03:19:18</td>\n",
       "      <td>9.65</td>\n",
       "      <td>38.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>40.50</td>\n",
       "      <td>High Fare</td>\n",
       "      <td>High distance trip</td>\n",
       "      <td>Y</td>\n",
       "      <td>...</td>\n",
       "      <td>12:01am - 6am, Early Morning</td>\n",
       "      <td>Brooklyn</td>\n",
       "      <td>Kensington</td>\n",
       "      <td>Cash</td>\n",
       "      <td>2023-01-11</td>\n",
       "      <td>03:19:18</td>\n",
       "      <td>13846.60</td>\n",
       "      <td>2382.60</td>\n",
       "      <td>16471.11</td>\n",
       "      <td>1070.56</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24616</th>\n",
       "      <td>Brooklyn</td>\n",
       "      <td>Bath Beach</td>\n",
       "      <td>2023-01-12 05:50:22</td>\n",
       "      <td>15.40</td>\n",
       "      <td>50.5</td>\n",
       "      <td>0.00</td>\n",
       "      <td>52.00</td>\n",
       "      <td>High Fare</td>\n",
       "      <td>High distance trip</td>\n",
       "      <td>Y</td>\n",
       "      <td>...</td>\n",
       "      <td>6:01am - 12pm, Morning</td>\n",
       "      <td>Queens</td>\n",
       "      <td>Richmond Hill</td>\n",
       "      <td>Credit card</td>\n",
       "      <td>2023-01-12</td>\n",
       "      <td>05:50:22</td>\n",
       "      <td>15789.53</td>\n",
       "      <td>2708.89</td>\n",
       "      <td>19027.50</td>\n",
       "      <td>1386.57</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>10 rows × 21 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      Pick Up Borough Pick Up Zone tpep_pickup_datetime  trip_distance  \\\n",
       "24603        Brooklyn   Bath Beach  2023-01-01 04:15:08          10.09   \n",
       "24604        Brooklyn   Bath Beach  2023-01-03 02:42:34          10.12   \n",
       "24606        Brooklyn   Bath Beach  2023-01-04 16:28:32           0.00   \n",
       "24608        Brooklyn   Bath Beach  2023-01-05 02:07:08           9.91   \n",
       "24611        Brooklyn   Bath Beach  2023-01-06 06:21:22          21.30   \n",
       "24612        Brooklyn   Bath Beach  2023-01-08 03:13:38           9.91   \n",
       "24613        Brooklyn   Bath Beach  2023-01-09 10:50:17           0.60   \n",
       "24614        Brooklyn   Bath Beach  2023-01-10 15:21:48           0.60   \n",
       "24615        Brooklyn   Bath Beach  2023-01-11 03:19:18           9.65   \n",
       "24616        Brooklyn   Bath Beach  2023-01-12 05:50:22          15.40   \n",
       "\n",
       "       fare_amount  tip_amount  total_amount fare_amount_flag  \\\n",
       "24603         40.1        0.00         42.60        High Fare   \n",
       "24604         39.4        0.00         41.90        High Fare   \n",
       "24606          3.0        0.00          7.00         Low Fare   \n",
       "24608         38.7        8.24         49.44        High Fare   \n",
       "24611         50.5        0.00         52.00        High Fare   \n",
       "24612         38.0        0.00         40.50        High Fare   \n",
       "24613         44.5        0.00         52.55        High Fare   \n",
       "24614          4.4        0.00          5.90         Low Fare   \n",
       "24615         38.0        0.00         40.50        High Fare   \n",
       "24616         50.5        0.00         52.00        High Fare   \n",
       "\n",
       "       Trip_Distance_Flag Airport(Y/N)  ...                DO_time_of_day  \\\n",
       "24603  High distance trip            Y  ...  12:01am - 6am, Early Morning   \n",
       "24604  High distance trip            Y  ...  12:01am - 6am, Early Morning   \n",
       "24606   Low distance trip            Y  ...  12:01pm - 6pm, Mid-Afternoon   \n",
       "24608  High distance trip            Y  ...  12:01am - 6am, Early Morning   \n",
       "24611  High distance trip            Y  ...        6:01am - 12pm, Morning   \n",
       "24612  High distance trip            Y  ...  12:01am - 6am, Early Morning   \n",
       "24613   Low distance trip            Y  ...        6:01am - 12pm, Morning   \n",
       "24614   Low distance trip            Y  ...  12:01pm - 6pm, Mid-Afternoon   \n",
       "24615  High distance trip            Y  ...  12:01am - 6am, Early Morning   \n",
       "24616  High distance trip            Y  ...        6:01am - 12pm, Morning   \n",
       "\n",
       "      Drop Off Borough  Drop Off Zone Payment_Type_Description        Date  \\\n",
       "24603         Brooklyn     Kensington                     Cash  2023-01-01   \n",
       "24604         Brooklyn     Kensington                     Cash  2023-01-03   \n",
       "24606         Brooklyn     Bath Beach                  Dispute  2023-01-04   \n",
       "24608         Brooklyn     Kensington              Credit card  2023-01-05   \n",
       "24611           Queens   Far Rockaway              Credit card  2023-01-06   \n",
       "24612         Brooklyn     Kensington                     Cash  2023-01-08   \n",
       "24613         Brooklyn     Bath Beach              Credit card  2023-01-09   \n",
       "24614         Brooklyn     Bath Beach                     Cash  2023-01-10   \n",
       "24615         Brooklyn     Kensington                     Cash  2023-01-11   \n",
       "24616           Queens  Richmond Hill              Credit card  2023-01-12   \n",
       "\n",
       "           Time fare_amount_sums  trip_distance_sums  total_amount_sums  \\\n",
       "24603  04:15:08         19877.91             3338.11           24960.94   \n",
       "24604  02:42:34         12755.90             2155.04           15524.35   \n",
       "24606  16:28:32         11176.80             1945.01           13581.55   \n",
       "24608  02:07:08         12442.38             2103.68           15180.13   \n",
       "24611  06:21:22         12451.60             2261.11           15349.37   \n",
       "24612  03:13:38         10654.02             1693.36           13000.23   \n",
       "24613  10:50:17         11345.30             1908.02           13276.23   \n",
       "24614  15:21:48         12667.05             2107.05           14975.29   \n",
       "24615  03:19:18         13846.60             2382.60           16471.11   \n",
       "24616  05:50:22         15789.53             2708.89           19027.50   \n",
       "\n",
       "       tip_amount_sums  \n",
       "24603          2574.34  \n",
       "24604          1242.20  \n",
       "24606           984.45  \n",
       "24608          1218.10  \n",
       "24611          1258.22  \n",
       "24612          1197.76  \n",
       "24613           673.48  \n",
       "24614           886.68  \n",
       "24615          1070.56  \n",
       "24616          1386.57  \n",
       "\n",
       "[10 rows x 21 columns]"
      ]
     },
     "execution_count": 125,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_brooklyn.head(10)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f6e446b0-663e-4ad7-877e-a1fa8d63b8da",
   "metadata": {},
   "source": [
    "It looks like I have successfully summed up all the columns I needed to, so now lets concatenate them into a new Q1 report for further analysis\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 129,
   "id": "ac23170f-e446-4273-bf9f-b6e3c6603308",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "['Bronx' 'Brooklyn' 'EWR' 'Manhattan' 'Queens' 'Staten Island']\n"
     ]
    }
   ],
   "source": [
    "# List of DataFrames to concatenate\n",
    "dfs = [df_bronx, df_brooklyn, df_ewr, df_manhattan, df_queens, df_staten_island]\n",
    "\n",
    "# Concatenate the DataFrames\n",
    "Q1YellowTaxi_Totals = pd.concat(dfs)\n",
    "\n",
    "unique_boroughs = Q1YellowTaxi_Totals[\"Pick Up Borough\"].unique()\n",
    "print(unique_boroughs)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 130,
   "id": "60bf9dae-d8be-4e92-87e4-70b285942570",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "['2023-01-02' '2023-01-03' '2023-01-04' '2023-01-05' '2023-01-09'\n",
      " '2023-01-10' '2023-01-12' '2023-01-13' '2023-01-14' '2023-01-15'\n",
      " '2023-01-16' '2023-01-19' '2023-01-21' '2023-01-22' '2023-01-23'\n",
      " '2023-01-24' '2023-01-25' '2023-01-27' '2023-01-28' '2023-01-29'\n",
      " '2023-01-30' '2023-02-03' '2023-02-06' '2023-02-07' '2023-02-08'\n",
      " '2023-02-09' '2023-02-10' '2023-02-11' '2023-02-12' '2023-02-14'\n",
      " '2023-02-15' '2023-02-16' '2023-02-17' '2023-02-18' '2023-02-20'\n",
      " '2023-02-21' '2023-02-22' '2023-02-23' '2023-02-25' '2023-02-26'\n",
      " '2023-02-27' '2023-03-01' '2023-03-02' '2023-03-03' '2023-03-05'\n",
      " '2023-03-06' '2023-03-07' '2023-03-08' '2023-03-09' '2023-03-10'\n",
      " '2023-03-13' '2023-03-14' '2023-03-16' '2023-03-17' '2023-03-18'\n",
      " '2023-03-20' '2023-03-21' '2023-03-22' '2023-03-23' '2023-03-27'\n",
      " '2023-03-28' '2023-03-29' '2023-03-30' '2023-03-31' '2023-04-03'\n",
      " '2023-04-04' '2023-04-05' '2023-04-06' '2023-04-07' '2023-04-08'\n",
      " '2023-04-09' '2023-04-10' '2023-04-11' '2023-04-12' '2023-04-13'\n",
      " '2023-04-14' '2023-04-15' '2023-04-16' '2023-04-18' '2023-04-19'\n",
      " '2023-04-20' '2023-04-23' '2023-04-24' '2023-04-25' '2023-04-26'\n",
      " '2023-04-27' '2023-04-28' '2023-04-29' '2023-01-01' '2023-01-06'\n",
      " '2023-01-07' '2023-01-08' '2023-01-11' '2023-01-17' '2023-01-18'\n",
      " '2023-01-20' '2023-01-26' '2023-01-31' '2023-02-01' '2023-02-02'\n",
      " '2023-02-04' '2023-02-13' '2023-02-24' '2023-02-28' '2023-03-04'\n",
      " '2023-03-11' '2023-03-12' '2023-03-15' '2023-03-24' '2023-03-25'\n",
      " '2023-04-01' '2023-04-02' '2023-04-17' '2023-04-21' '2023-04-22'\n",
      " '2023-04-30' '2023-03-19' '2023-02-19' '2023-03-26' '2023-02-05'\n",
      " '2022-10-24' '2022-10-25' '2022-12-31' '2023-05-02' '2023-05-03'\n",
      " '2023-05-01' '2009-01-01' '2008-12-31' '2002-12-31' '2001-01-01'\n",
      " '2003-01-01' '2014-11-19']\n"
     ]
    }
   ],
   "source": [
    "unique_boroughs = Q1YellowTaxi_Totals[\"Date\"].unique()\n",
    "print(unique_boroughs)\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "55a79b05-d8d5-4210-a1d5-c6f61c6e5ef5",
   "metadata": {},
   "source": [
    "By printing the unique values of the column Pick Up Borough and Date I can verify that my newly concatenated dataframe is successful!! Now lets export!!"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 135,
   "id": "a479dd66-f7fe-422a-adc0-a3b2fbdee5ac",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Define the list of valid months\n",
    "valid_months = [\"2023-01\", \"2023-02\", \"2023-03\", \"2023-04\"]\n",
    "\n",
    "# Filter the DataFrame for Date values in the valid months\n",
    "Q1YellowTaxi_Totals = Q1YellowTaxi_Totals[\n",
    "    Q1YellowTaxi_Totals[\"Date\"].str.startswith(tuple(valid_months))\n",
    "]\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ff6bd46c-fb7b-45f2-a916-18566142065e",
   "metadata": {},
   "source": [
    "I noticed that the Date column had values outside of Q1 2023 so I reviewed quickly in Excel and then used the filter script above to remove all dates outside of Q1 2023 and then exported again!"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 136,
   "id": "326df94a-257b-4801-8729-f8dbd9d60b18",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "CSV file saved: C:\\Users\\reece\\Downloads\\Final Project - Career Foundry\\Final working files\\Monthly Borough Taxi Reports\\Prepared Data\\Final Folder\\Q1YellowTaxi_Totals.csv\n"
     ]
    }
   ],
   "source": [
    "# Specify the file path\n",
    "file_path = r\"C:\\Users\\reece\\Downloads\\Final Project - Career Foundry\\Final working files\\Monthly Borough Taxi Reports\\Prepared Data\\Final Folder\"\n",
    "\n",
    "# Create the file name\n",
    "file_name = \"Q1YellowTaxi_Totals.csv\"\n",
    "\n",
    "# Concatenate the file path and file name\n",
    "output_file = os.path.join(file_path, file_name)\n",
    "\n",
    "# Save the DataFrame as a CSV file\n",
    "Q1YellowTaxi_Totals.to_csv(output_file, index=False)\n",
    "\n",
    "# Print the output file path\n",
    "print(f\"CSV file saved: {output_file}\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "cd0da5b2-35e4-40e9-a62c-11f7720bcbd6",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a91674c2-92f7-488d-832c-81bd2f1c7459",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d04aa6ce-7bbb-448f-a1dd-71bf8fd8c872",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4aa539ff-8f7d-4abf-9c75-64b908e90046",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.9"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
